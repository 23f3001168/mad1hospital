<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Doctor Dashboard</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body { background: #f3f5f9; }
        .box { background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        h2 { font-weight: 700; }
        .section-title { font-size: 1.2rem; font-weight: 600; margin-top: 20px; }
    </style>
</head>

<body>

<div class="container mt-4">

    <div class="box">
        <h2>Welcome, Dr. {{ doctor.user.fname }} {{ doctor.user.lname }}</h2>
        <p class="text-muted">Specialization: <strong>{{ doctor.spec }}</strong></p>

        <div class="d-grid gap-3 mt-4">
            <a href="/doctor/appointments" class="btn btn-primary">View All Appointments</a>
        </div>

        <hr class="my-4">

        <div class="section-title">Upcoming Appointments (Next 7 Days)</div>

        {% if upcoming_appointments %}
            <ul class="list-group mt-2">
                {% for a in upcoming_appointments %}
                    <li class="list-group-item">
                        <strong>{{ a.date }} at {{ a.time }}</strong><br>
                        Patient: {{ a.patient.user.fname }} {{ a.patient.user.lname }}
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="text-muted">No upcoming appointments.</p>
        {% endif %}

        <hr class="my-4">

        <div class="section-title">Your Patients</div>

        {% if assigned_patients %}
            <ul class="list-group mt-2">
                {% for p in assigned_patients %}
                    <li class="list-group-item d-flex justify-content-between">
                        {{ p.user.fname }} {{ p.user.lname }}
                        <a href="/doctor/patient/history/{{ p.id }}" class="btn btn-sm btn-outline-primary">View History</a>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="text-muted">No assigned patients yet.</p>
        {% endif %}

        <hr class="my-4">

        <div class="section-title">Set Availability (Next 7 Days)</div>

        <form method="POST" action="/doctor/availability" class="mt-3">
            <label class="form-label">Select Date:</label>
            <input type="date" name="date" class="form-control" required>

            <label class="form-label mt-2">Time Slots (comma separated):</label>
            <input type="text" name="slots" class="form-control" placeholder="10:00-11:00, 14:00-16:00" required>

            <button class="btn btn-success mt-3 w-100">Submit Availability</button>
        </form>

        <hr class="my-4">

        <div class="d-grid">
            <a href="/logout" class="btn btn-danger">Logout</a>
        </div>

    </div>

</div>

</body>
</html>